import Dexie, { Table } from 'dexie';import { TemplateRegistry } from '../templates';/* ======================================================   CORE STATE (Hive: coreBox)   ====================================================== */export interface CoreState {  id: 'core';  schemaVersion: number;  lastApprovedSnapshotId?: string;  updatedAt: number;}/* ======================================================   TEMPLATE SAFETY   ====================================================== */export type TemplateId = keyof typeof TemplateRegistry;/* ======================================================   MENU   ====================================================== */export interface MenuItem {  id: string;  nameTR: string;  nameEN?: string;  templateId: TemplateId;     //  sadece kaytl template  recipeId?: string;  tags: string[];  available: boolean;  createdAt: number;  updatedAt: number;}/* ======================================================   RECIPE   ====================================================== */export interface Recipe {  id: string;  ingredients: string[];  steps: string[];  pairings?: string[];  notes?: string;  createdAt: number;  updatedAt: number;}/* ======================================================   UPDATE / CHANGESET   ====================================================== */export type ChangeSetStatus =  | 'draft'  | 'review'  | 'approved'  | 'published';export interface ChangeSet {  id: string;  baseSnapshotId?: string;  status: ChangeSetStatus;  patches: any[];  createdAt: number;  approvedAt?: number;  approvedBy?: string;}/* ======================================================   SNAPSHOT   ====================================================== */export interface Snapshot {  id: string;  contentHash: string;  menuVersion: number;  createdAt: number;  approvedBy?: string;}/* ======================================================   DATABASE   ====================================================== */class QRMenuDB extends Dexie {  core!: Table<CoreState, 'core'>;  menuItems!: Table<MenuItem, string>;  recipes!: Table<Recipe, string>;  changeSets!: Table<ChangeSet, string>;  snapshots!: Table<Snapshot, string>;  constructor() {    super('qr-menu-db');    this.version(1).stores({      core: 'id',      menuItems: 'id, templateId, available, updatedAt',      recipes: 'id, updatedAt',      changeSets: 'id, status, createdAt',      snapshots: 'id, menuVersion, createdAt'    });  }}export const db = new QRMenuDB();
